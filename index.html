<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Allocations</title>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <style>
    body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
}

h1, h2 {
  color: #4b6584;
}

.dropdown-container {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.speciality-dropdown, .location-dropdown {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: #ffffff;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
  padding: 15px;
  margin-bottom: 15px;
  width: 100%;
}

.speciality-dropdown select, .location-dropdown select {
  display: inline-block;
  width: 100%;
  padding: 0.5rem 1rem;
  font-size: 16px;
  font-weight: bold;
  border: none;
  border-radius: 5px;
  appearance: none;
  background-color: #4b6584;
  color: #fff;
  cursor: pointer;
  margin-top: 5px;
}

.speciality-dropdown:after, .location-dropdown:after {
  content: '\25BC';
  position: absolute;
  top: 0.5rem;
  right: 1rem;
  padding: 0.5rem;
  pointer-events: none;
  color: #fff;
}

.speciality-dropdown select:focus, .location-dropdown select:focus {
  outline: none;
  box-shadow: 0px 0px 5px #ccc;
}

.speciality-dropdown:hover select, .location-dropdown:hover select {
  background-color: #367d39;
}

#allocation-table {
  margin: 1rem auto;
  border-collapse: collapse;
  width: 100%;
  max-width: 800px;
}

#allocation-table td, #allocation-table th {
  border: 1px solid #ddd;
  padding: 8px;
}

#allocation-table tr:nth-child(even) {
  background-color: #f2f2f2;
}

#allocation-table th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #4b6584;
  color: white;
}

#allocation-table th:hover {
  background-color: #367d39;
}

#allocation-table td a {
  color: #0000ff;
  text-decoration: underline;
}

#allocation-table td a:hover {
  color: #ff0000;
  text-decoration: none;
}
 </style>
</head>
<body>
  <div class="container">
    <h1 class="text-center my-4">Allocations</h1>
    <div class="row">
      <div class="col-md-6">
        <div id="specialities-container" class="dropdown-container mb-5">
          <h2 class="text-center mb-3">Specialities</h2>
          <div id="score" class="d-flex flex-column align-items-center"></div>
        </div>
      </div>
      <div class="col-md-6">
        <div id="locations-container" class="dropdown-container mb-5">
          <h2 class="text-center mb-3">Locations</h2>
          <div id="location-score" class="d-flex flex-column align-items-center"></div>
        </div>
      </div>
    </div> <!-- Close the nested row div -->
    <div class="row">
      <div class="col-md-12 text-center">
        <button id="calculate-button" class="btn btn-primary mt-4 mb-5">Calculate Rankings</button>
      </div>
    </div>
    <table id="allocation-table" class="table table-bordered table-striped">
      <!-- table contents here -->
    </table>
  </div>
  <script>
   <script>
   fetch('https://raw.githubusercontent.com/AriAb247/Ariab247.github.io/main/Allocations_sheet.csv')
  .then(response => response.text())
  .then(csv => {
    const data = Papa.parse(csv, { header: true }).data;

    const specialities = [...new Set(data.map(d => d.speciality))].sort();
    const scoreContainer = document.getElementById('score');

    for (let i = 0; i < specialities.length; i++) {
      const speciality = specialities[i];
      const scoreEl = document.createElement('div');
      scoreEl.innerHTML = `${speciality}: `;
      const scoreDropdown = document.createElement('select');
      scoreDropdown.setAttribute('data-speciality', speciality);
      scoreDropdown.addEventListener('change', () => {
        const scores = JSON.parse(localStorage.getItem('scores')) || {};
        scores[speciality] = scoreDropdown.value;
        localStorage.setItem('scores', JSON.stringify(scores));
        updateScores();
      });
      for (let j = -10; j <= 10; j++) {
        const option = document.createElement('option');
        option.value = j;
        option.text = j;
        scoreDropdown.appendChild(option);
      }
      scoreEl.appendChild(scoreDropdown);
      scoreContainer.appendChild(scoreEl);
    }

    const locations = [...new Set(data.map(d => d.location))].sort();
    const locationScoreContainer = document.getElementById('location-score');

    for (let i = 0; i < locations.length; i++) {
      const location = locations[i];
      const locationScoreEl = document.createElement('div');
      locationScoreEl.innerHTML = `${location}: `;
      const locationScoreDropdown = document.createElement('select');
      locationScoreDropdown.setAttribute('data-location', location);
      locationScoreDropdown.addEventListener('change', () => {
        const locationScores = JSON.parse(localStorage.getItem('locationScores')) || {};
        locationScores[location] = locationScoreDropdown.value;
        localStorage.setItem('locationScores', JSON.stringify(locationScores));
        updateLocationScores();
      });
      for (let j = -10; j <= 10; j++) {
        const option = document.createElement('option');
        option.value = j;
        option.text = j;
        locationScoreDropdown.appendChild(option);
      }
      locationScoreEl.appendChild(locationScoreDropdown);
      locationScoreContainer.appendChild(locationScoreEl);
    }

    function updateScores() {
      const scores = JSON.parse(localStorage.getItem('scores')) || {};
      for (let i = 0; i < specialities.length; i++) {
        const speciality = specialities[i];
        const scoreDropdown = document.querySelector(`[data-speciality="${speciality}"]`);
        const score = scores[speciality] || 0;
        scoreDropdown.value = score;
      }
    }

    function updateLocationScores() {
      const locationScores = JSON.parse(localStorage.getItem('locationScores')) || {};
      for (let i = 0; i < locations.length; i++) {
        const location = locations[i];
        const locationDropdown = document.querySelector(`[data-location="${location}"]`);
        const score = locationScores[location] || 0;
        locationDropdown.value = score;
      }
    }

    const table = document.getElementById('allocation-table');
    table.style.display = 'none';

    // Initialize the UI
    updateScores();
    updateLocationScores();

    // Create an array to store the allocations
    const allocations = data.map(d => ({
      speciality: d.speciality,
      location: d.location,
      title:
      title: d.title,
      score: 0
    }));

    // Add a click event listener to the button
    document.getElementById('calculate-button').addEventListener('click', () => {
      // Calculate the score for each allocation
      allocations.forEach(allocation => {
        const specialityScore = parseInt(JSON.parse(localStorage.getItem('scores'))[allocation.speciality] || '0');
        const locationScore = parseInt(JSON.parse(localStorage.getItem('locationScores'))[allocation.location] || '0');
        allocation.score = specialityScore + locationScore;
      });

      // Sort the allocations based on their scores
      allocations.sort((a, b) => b.score - a.score);

      // Clear the table and add sorted allocations
      const table = document.getElementById('allocation-table');
      table.innerHTML = '';
      const headerRow = document.createElement('tr');
      headerRow.innerHTML = `
        <th>Title</th>
        <th>Score</th>
      `;
      table.appendChild(headerRow);

      allocations.forEach(allocation => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${allocation.title}</td>
          <td>${allocation.score}</td>
        `;
        table.appendChild(row);
      });

      // Display the table
      table.style.display = 'table';
    });

  });
</script>
</body>
</html>



